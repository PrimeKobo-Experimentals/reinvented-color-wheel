!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ReinventedColorWheel=t()}(this,function(){"use strict";var i=function(e){var t=e[0],n=e[1]/100,i=e[2]/100;return 0===i?[0,0,0]:[t,2*(n*=(i*=2)<=1?i:2-i)/(i+n)*100,(i+n)/2*100]};var d,c,h,a=function(e){var t,n,i=e[0],h=e[1]/100,s=e[2]/100;return t=h*s,[i,100*(t=(t/=(n=(2-h)*s)<=1?n:2-n)||0),100*(n/=2)]},e="PointerEvent"in window;e&&"ontouchend"in window?(d=function(e,t){return e.addEventListener("touchstart",function(e){e.preventDefault(),t(e.targetTouches[0])})},c=function(e,t){return e.addEventListener("touchmove",function(e){e.preventDefault(),t(e.targetTouches[0])})}):(d=function(t,n){return t.addEventListener(e?"pointerdown":"mousedown",function(e){h=t,n(e)})},c=function(t,n){return addEventListener(e?"pointermove":"mousemove",function(e){h===t&&n(e)})},addEventListener(e?"pointerup":"mouseup",function(){return h=void 0}));var u={h:0,s:100,l:50,wheelDiameter:200,wheelThickness:20,handleDiameter:16,onChange:function(){}};function p(e){return"number"==typeof e&&isFinite(e)}function v(e){return e<0?0:100<e?100:e+.5|0}function f(e){e.preventDefault()}function m(e,t){var n=document.createElement(e);return n.className=t,n}return function(){function e(e){this.options=e,this.h=NaN,this.s=NaN,this.l=NaN,this.wheelDiameter=this.options.wheelDiameter||u.wheelDiameter,this.wheelThickness=this.options.wheelThickness||u.wheelThickness,this.handleDiameter=this.options.handleDiameter||u.handleDiameter,this.onChange=this.options.onChange||u.onChange,this.containerElement=this.options.parentElement.appendChild(m("div","reinvented-color-wheel")),this.hueWheelElement=this.containerElement.appendChild(m("canvas","reinvented-color-wheel--hue-wheel")),this.hueHandleElement=this.containerElement.appendChild(m("div","reinvented-color-wheel--hue-handle")),this.hueInnerCircleElement=this.containerElement.appendChild(m("div","reinvented-color-wheel--hue-inner-circle")),this.svSpaceElement=this.containerElement.appendChild(m("canvas","reinvented-color-wheel--sv-space")),this.svHandleElement=this.containerElement.appendChild(m("div","reinvented-color-wheel--sv-handle"));var t=this.wheelDiameter,n=this.wheelThickness;this.containerElement.addEventListener("pointerdown",f),this.containerElement.addEventListener("mousedown",f);var i=this.hueWheelElement,h=this._onMoveHueHandle.bind(this);i.width=i.height=t,d(i,h),c(i,h);var s=this.hueHandleElement.style,o=this.svHandleElement.style,r=this.handleDiameter;s.width=s.height=o.width=o.height=r+"px",s.marginLeft=s.marginTop=o.marginLeft=o.marginTop=-r/2+"px",this.hueInnerCircleElement.style.width=this.hueInnerCircleElement.style.height=t-n-n+"px";var l=this.svSpaceElement,a=this._onMoveSvHandle.bind(this);l.width=l.height=(t-n-n)*Math.sqrt(2)/2,d(l,a),c(l,a),this.setHSL({h:p(e.h)?e.h:u.h,s:p(e.s)?e.s:u.s,l:p(e.l)?e.l:u.l})}return e.prototype.setHSL=function(e){var t,n,i,h=this.h,s=this.s,o=this.l;p(e.h)&&(this.h=(t=e.h,(i=(t+.5|0)%(n=360))<0?i+n:i)),p(e.s)&&(this.s=v(e.s)),p(e.l)&&(this.l=v(e.l));var r=h!==this.h,l=s!==this.s||o!==this.l;r&&(this._redrawHueHandle(),this._redrawSvSpace()),l&&(this._redrawHueWheel(),this._redrawSvHandle()),(r||l)&&this.onChange(this)},e.prototype._redrawHueWheel=function(){for(var e=this.wheelDiameter/2,t=e-this.wheelThickness/2,n=this.hueWheelElement.getContext("2d"),i=Math.PI/180,h=0;h<360;h++)n.beginPath(),n.arc(e,e,t,(h-90.6)*i,(h-89.4)*i),n.strokeStyle="hsl("+h+","+this.s+"%,"+this.l+"%)",n.lineWidth=this.wheelThickness,n.stroke()},e.prototype._redrawSvSpace=function(){var e=this.svSpaceElement,t=e.width,n=t/100,i=e.getContext("2d"),h=this.h;i.clearRect(0,0,t,t);for(var s=0;s<100;s++){var o=i.createLinearGradient(0,0,0,t),r=a([h,s,100]),l=a([h,s,0]);o.addColorStop(0,"hsl("+h+","+r[1]+"%,"+r[2]+"%)"),o.addColorStop(1,"hsl("+h+","+l[1]+"%,"+l[2]+"%)"),i.fillStyle=o,i.fillRect(s*n|0,0,n+1|0,t)}},e.prototype._redrawHueHandle=function(){var e=this.wheelDiameter/2,t=e-this.wheelThickness/2,n=(this.h-90)*Math.PI/180,i=this.hueHandleElement.style;i.left=t*Math.cos(n)+e+"px",i.top=t*Math.sin(n)+e+"px"},e.prototype._redrawSvHandle=function(){var e=i([this.h,this.s,this.l]),t=this.svSpaceElement,n=this.svHandleElement.style;n.left=t.offsetLeft+t.offsetWidth*e[1]/100+"px",n.top=t.offsetTop+t.offsetHeight*(1-e[2]/100)+"px"},e.prototype._onMoveHueHandle=function(e){var t=this.hueWheelElement.getBoundingClientRect(),n=this.wheelDiameter/2,i=e.clientX-t.left-n,h=e.clientY-t.top-n,s=Math.atan2(h,i);this.setHSL({h:180*s/Math.PI+90})},e.prototype._onMoveSvHandle=function(e){var t=this.svSpaceElement.getBoundingClientRect(),n=100*(e.clientX-t.left)/t.width,i=100*(t.bottom-e.clientY)/t.height,h=a([this.h,n,i]);this.setHSL({s:h[1],l:h[2]})},e.defaultOptions=u,e}()});