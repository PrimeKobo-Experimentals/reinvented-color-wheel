!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ReinventedColorWheel=t()}(this,function(){"use strict";var t=function(e){var t=e[0],n=e[1]/100,i=e[2]/100;return 0===i?[0,0,0]:[t,2*(n*=(i*=2)<=1?i:2-i)/(i+n)*100,(i+n)/2*100]};var d,u,i,l=function(e){var t,n,i=e[0],h=e[1]/100,s=e[2]/100;return t=h*s,[i,100*(t=(t/=(n=(2-h)*s)<=1?n:2-n)||0),100*(n/=2)]};"PointerEvent"in window?(d=function(t,n){return t.addEventListener("pointerdown",function(e){return i=t,n(e)})},u=function(t,n){return addEventListener("pointermove",function(e){return i===t&&n(e)})},addEventListener("pointerup",function(){return i=void 0})):"ontouchend"in window?(d=function(e,t){return e.addEventListener("touchstart",function(e){return e.preventDefault(),t(e.targetTouches[0])})},u=function(e,t){return e.addEventListener("touchmove",function(e){return e.preventDefault(),t(e.targetTouches[0])})}):(d=function(t,n){return t.addEventListener("mousedown",function(e){return i=t,n(e)})},u=function(t,n){return addEventListener("mousemove",function(e){return i===t&&n(e)})},addEventListener("mouseup",function(){return i=void 0}));var c={h:0,s:100,l:50,wheelDiameter:200,wheelThickness:20,handleDiameter:16,onChange:function(){}};function s(e,t,n){return Math.min(Math.max(0|e,t),n)}function p(e){e.preventDefault()}function v(e,t){var n=document.createElement(e);return n.className=t,n}return function(){function e(e){this.options=e,this.h=NaN,this.s=NaN,this.l=NaN,this.wheelDiameter=this.options.wheelDiameter||c.wheelDiameter,this.wheelThickness=this.options.wheelThickness||c.wheelThickness,this.handleDiameter=this.options.handleDiameter||c.handleDiameter,this.onChange=this.options.onChange||c.onChange,this.containerElement=this.options.parentElement.appendChild(v("div","reinvented-color-wheel")),this.hueWheelElement=this.containerElement.appendChild(v("canvas","reinvented-color-wheel--hue-wheel")),this.hueHandleElement=this.containerElement.appendChild(v("div","reinvented-color-wheel--hue-handle")),this.hueInnerCircleElement=this.containerElement.appendChild(v("div","reinvented-color-wheel--hue-inner-circle")),this.svSpaceElement=this.containerElement.appendChild(v("canvas","reinvented-color-wheel--sv-space")),this.svHandleElement=this.containerElement.appendChild(v("div","reinvented-color-wheel--sv-handle"));var t=this.wheelDiameter,n=this.wheelThickness;this.containerElement.addEventListener("pointerdown",p),this.containerElement.addEventListener("mousedown",p);var i=this.hueWheelElement,h=this._onMoveHueHandle.bind(this);i.width=i.height=t,d(i,h),u(i,h);var s=this.hueHandleElement.style,r=this.svHandleElement.style,o=this.handleDiameter;s.width=s.height=r.width=r.height=o+"px",s.marginLeft=s.marginTop=r.marginLeft=r.marginTop=-o/2+"px",this.hueInnerCircleElement.style.width=this.hueInnerCircleElement.style.height=t-n-n+"px";var l=this.svSpaceElement,a=this._onMoveSvHandle.bind(this);l.width=l.height=(t-n-n)*Math.sqrt(2)*.5,d(l,a),u(l,a),this.setHSL({h:"number"==typeof e.h?e.h:c.h,s:"number"==typeof e.s?e.s:c.s,l:"number"==typeof e.l?e.l:c.l})}return e.prototype.setHSL=function(e){var t,n,i,h;"number"==typeof e.s&&e.s!==this.s&&(this.s=s(e.s,0,100),t=!0),"number"==typeof e.l&&e.l!==this.l&&(this.l=s(e.l,0,100),t=!0),t&&(this._redrawHueWheel(),this._redrawSvHandle()),"number"==typeof e.h&&e.h!==this.h?(this.h=(n=e.h,(h=(0|n)%(i=360))<0?h+i:h),this._redrawHueHandle(),this._redrawSvSpace(),this.onChange(this)):t&&this.onChange(this)},e.prototype._redrawHueWheel=function(){for(var e=this.wheelDiameter/2,t=e-this.wheelThickness/2,n=this.hueWheelElement.getContext("2d"),i=Math.PI/180,h=0;h<360;h++)n.beginPath(),n.arc(e,e,t,(h-90.6)*i,(h-89.4)*i),n.strokeStyle="hsl("+h+","+this.s+"%,"+this.l+"%)",n.lineWidth=this.wheelThickness,n.stroke()},e.prototype._redrawSvSpace=function(){var e=this.svSpaceElement,t=e.width,n=t/100,i=e.getContext("2d");i.clearRect(0,0,t,t);for(var h=0;h<100;h++){var s=i.createLinearGradient(0,0,0,t),r=l([this.h,h,100]),o=l([this.h,h,0]);s.addColorStop(0,"hsl("+r[0]+","+r[1]+"%,"+r[2]+"%)"),s.addColorStop(1,"hsl("+o[0]+","+o[1]+"%,"+o[2]+"%)"),i.fillStyle=s,i.fillRect(h*n|0,0,n+1|0,t)}},e.prototype._redrawHueHandle=function(){var e=this.wheelDiameter/2,t=e-this.wheelThickness/2,n=(this.h-90)*Math.PI/180;this.hueHandleElement.style.left=t*Math.cos(n)+e+"px",this.hueHandleElement.style.top=t*Math.sin(n)+e+"px"},e.prototype._redrawSvHandle=function(){var e=t([this.h,this.s,this.l]);this.svHandleElement.style.left=this.svSpaceElement.offsetLeft+this.svSpaceElement.offsetWidth*e[1]/100+"px",this.svHandleElement.style.top=this.svSpaceElement.offsetTop+this.svSpaceElement.offsetHeight*(1-e[2]/100)+"px"},e.prototype._onMoveHueHandle=function(e){var t=this.hueWheelElement.getBoundingClientRect(),n=this.wheelDiameter/2,i=e.clientX-t.left-n,h=e.clientY-t.top-n,s=Math.atan2(h,i);this.setHSL({h:180*s/Math.PI+90})},e.prototype._onMoveSvHandle=function(e){var t=this.svSpaceElement.getBoundingClientRect(),n=s(e.clientX-t.left,0,t.width-1),i=s(e.clientY-t.top,0,t.height-1),h=l([this.h,100*n/t.width|0,100-100*i/t.height|0]);this.setHSL({s:h[1],l:h[2]})},e.defaultOptions=c,e}()});